"0",""
"0","# April peaks and valleys"
"0","aprilpv <- roya_avg %>% "
"0","  filter(plantgen == ""all"") %>%"
"0","  full_join(fill.dates, by = ""date"") %>%"
"0","  find_peakvalley(valuecol = ""inf_mn"", datecol = ""date"", max.offset = 5) %>% "
"0","  mutate(april = as.numeric(format(.$date, ""%m"")==""04"")) %>%"
"0","  find_runs(start.run = ""april"", run.prefix = ""a"") %>% "
"0","  filter(runtype == ""growth"")"
"2","[38;5;232m`summarise()` has grouped output by 'ID'. You can override using the
`.groups` argument.[39m
"
"0","aprilruns <- aprilpv %>% select(date, runID) %>%"
"0","  group_by(runID) %>%"
"0","  mutate(runYear = format(min(date), ""%Y"")) %>%"
"0","  mutate(numYear = as.numeric(runYear)-2013) %>%"
"0","  mutate(runLength = 12*(max(date) - min(date))) %>%"
"0","  mutate(incr_month = 12*(date - min(date))) %>% "
"0","  mutate(half1 = as.numeric(date <= findmiddle(date,1))) %>%"
"0","  mutate(half2 = as.numeric(date >= findmiddle(date,2))) %>%"
"0","  ungroup()"
"0",""
"0","aprIDs <- unique(aprilruns$runID)"
"0",""
"0","april_halfs <- list()"
"0","for(i in 1:length(aprIDs)){"
"0","  april_halfs[[i]] <- aprilruns %>% "
"0","    filter(runID == aprIDs[i] & half1 == 1) %>%"
"0","    mutate(firsthalf = 1) %>%"
"0","      bind_rows(aprilruns %>% "
"0","                  filter(runID == aprIDs[i] & half2 == 1) %>%"
"0","                  mutate(firsthalf = 0)) %>%"
"0","    # group_by(firsthalf) %>% "
"0","    # mutate(n.half = 12*(max(date) - min(date)) + 1) %>%"
"0","    # mutate(t.half = (12*(date - min(date)) + 1)/n.half) %>%"
"0","    ungroup() "
"0","}"
"0","april_halfs <- bind_rows(april_halfs)"
"0",""
"0",""
"0","# Plot ""true"" peaks and valleys"
"0","royapv <- roya_avg %>% filter(plantgen == ""all"") %>%"
"0","  full_join(fill.dates, by = ""date"") %>%"
"0","  find_peakvalley(valuecol = ""inf_mn"", datecol = ""date"", max.offset = 5) %>%"
"0","  find_runs() %>% filter(runtype == ""growth"") "
"2","[38;5;232m`summarise()` has grouped output by 'ID'. You can override using the
`.groups` argument.[39m
"
"0","royaruns <- royapv %>% select(date, end.num, runID) %>%"
"0","  group_by(runID) %>%"
"0","  mutate(startDate = min(date)) %>%"
"0","  mutate(startMonth = as.numeric(format(startDate, ""%m""))) %>%"
"0","  mutate(runLength = 12*(max(date) - min(date))) %>%"
"0","  mutate(incr_month = 12*(date - startDate)) %>%"
"0","  mutate(runYear = format(startDate, ""%Y"")) %>%"
"0","  mutate(numYear = as.numeric(runYear)-2013) %>%"
"0","  mutate(half1 = as.numeric(date <= findmiddle(date,1))) %>%"
"0","  mutate(half2 = as.numeric(date >= findmiddle(date,2))) %>%"
"0","  ungroup()"
"0",""
"0","pvIDs <- unique(royaruns$runID)"
"0","pv_halfs <- list()"
"0","for(i in 1:length(pvIDs)){"
"0","  pv_halfs[[i]] <- royaruns %>% "
"0","    filter(runID == pvIDs[i] & half1 == 1) %>%"
"0","    mutate(firsthalf = 1) %>%"
"0","      bind_rows(royaruns %>% "
"0","                  filter(runID == pvIDs[i] & half2 == 1) %>%"
"0","                  mutate(firsthalf = 0)) %>%"
"0","    # group_by(firsthalf) %>% "
"0","    # mutate(n.half = 12*(max(date) - min(date)) + 1) %>%"
"0","    # mutate(t.half = (12*(date - min(date)) + 1)/n.half) %>%"
"0","    ungroup()"
"0","}"
"0","pv_halfs <- bind_rows(pv_halfs)"
"0",""
